/*
* Copyright (c) 2019 Semidrive Semiconductor.
* All rights reserved.
*
*/

#include <sys/types.h>
#include <string.h>
#include <sd_hash.h>
#include <trace.h>

#define LOCAL_TRACE 1 //close local trace 1->0

uint8_t __attribute__((aligned(CACHE_LINE))) md5_iv[MD5_INITSIZE] =
    "\x01\x23\x45\x67\x89\xab\xcd\xef\xfe\xdc\xba\x98\x76\x54\x32\x10";
uint8_t __attribute__((aligned(CACHE_LINE))) sha1_iv[SHA1_INITSIZE] =
    "\x67\x45\x23\x01\xef\xcd\xab\x89\x98\xba\xdc\xfe\x10\x32\x54\x76"
    "\xc3\xd2\xe1\xf0";
uint8_t __attribute__((aligned(CACHE_LINE))) sha224_iv[SHA224_INITSIZE] =
    "\xc1\x05\x9e\xd8\x36\x7c\xd5\x07\x30\x70\xdd\x17\xf7\x0e\x59\x39"
    "\xff\xc0\x0b\x31\x68\x58\x15\x11\x64\xf9\x8f\xa7\xbe\xfa\x4f\xa4";
uint8_t __attribute__((aligned(CACHE_LINE))) sha256_iv[SHA256_INITSIZE] =
    "\x6a\x09\xe6\x67\xbb\x67\xae\x85\x3c\x6e\xf3\x72\xa5\x4f\xf5\x3a"
    "\x51\x0e\x52\x7f\x9b\x05\x68\x8c\x1f\x83\xd9\xab\x5b\xe0\xcd\x19";
uint8_t __attribute__((aligned(CACHE_LINE))) sha384_iv[SHA384_INITSIZE] =
    "\xcb\xbb\x9d\x5d\xc1\x05\x9e\xd8\x62\x9a\x29\x2a\x36\x7c\xd5\x07"
    "\x91\x59\x01\x5a\x30\x70\xdd\x17\x15\x2f\xec\xd8\xf7\x0e\x59\x39"
    "\x67\x33\x26\x67\xff\xc0\x0b\x31\x8e\xb4\x4a\x87\x68\x58\x15\x11"
    "\xdb\x0c\x2e\x0d\x64\xf9\x8f\xa7\x47\xb5\x48\x1d\xbe\xfa\x4f\xa4";
uint8_t __attribute__((aligned(CACHE_LINE))) sha512_iv[SHA512_INITSIZE] =
    "\x6a\x09\xe6\x67\xf3\xbc\xc9\x08\xbb\x67\xae\x85\x84\xca\xa7\x3b"
    "\x3c\x6e\xf3\x72\xfe\x94\xf8\x2b\xa5\x4f\xf5\x3a\x5f\x1d\x36\xf1"
    "\x51\x0e\x52\x7f\xad\xe6\x82\xd1\x9b\x05\x68\x8c\x2b\x3e\x6c\x1f"
    "\x1f\x83\xd9\xab\xfb\x41\xbd\x6b\x5b\xe0\xcd\x19\x13\x7e\x21\x79";
uint8_t __attribute__((aligned(CACHE_LINE))) sm3_iv[SM3_INITSIZE] =
    "\x73\x80\x16\x6f\x49\x14\xb2\xb9\x17\x24\x42\xd7\xda\x8a\x06\x00"
    "\xa9\x6f\x30\xbc\x16\x31\x38\xaa\xe3\x8d\xee\x4d\xb0\xfb\x0e\x4e";

char __attribute__((aligned(CACHE_LINE))) input_data[64] = "abcdbcdecdefdefgefghfghighijhijkijkljklmklmnlmnomnopnopq";
uint32_t inputdata_size = 56;

char __attribute__((aligned(CACHE_LINE))) key[32] = "password";
uint32_t key_size = 8;

uint8_t __attribute__((aligned(CACHE_LINE))) expected_digest_md5[MD5_DIGESTSIZE] =
    "\x82\x15\xef\x07\x96\xa2\x0b\xca\xaa\xe1\x16\xd3\x87\x6c\x66\x4a";
uint8_t __attribute__((aligned(CACHE_LINE))) expected_digest_sha1[SHA1_DIGESTSIZE] =
    "\x84\x98\x3e\x44\x1c\x3b\xd2\x6e\xba\xae\x4a\xa1\xf9\x51\x29\xe5"
    "\xe5\x46\x70\xf1";
uint8_t __attribute__((aligned(CACHE_LINE))) expected_digest_sha224[SHA224_DIGESTSIZE] =
    "\x75\x38\x8B\x16\x51\x27\x76\xCC\x5D\xBA\x5D\xA1\xFD\x89\x01\x50"
    "\xB0\xC6\x45\x5C\xB4\xF5\x8B\x19\x52\x52\x25\x25";
uint8_t __attribute__((aligned(CACHE_LINE))) expected_digest_sha256[SHA256_DIGESTSIZE] =
    "\x24\x8D\x6A\x61\xD2\x06\x38\xB8\xE5\xC0\x26\x93\x0C\x3E\x60\x39"
    "\xA3\x3C\xE4\x59\x64\xFF\x21\x67\xF6\xEC\xED\xD4\x19\xDB\x06\xC1";
uint8_t __attribute__((aligned(CACHE_LINE))) expected_digest_sha384[SHA384_DIGESTSIZE] =
    "\x33\x91\xfd\xdd\xfc\x8d\xc7\x39\x37\x07\xa6\x5b\x1b\x47\x09\x39"
    "\x7c\xf8\xb1\xd1\x62\xaf\x05\xab\xfe\x8f\x45\x0d\xe5\xf3\x6b\xc6"
    "\xb0\x45\x5a\x85\x20\xbc\x4e\x6f\x5f\xe9\x5b\x1f\xe3\xc8\x45\x2b";
uint8_t __attribute__((aligned(CACHE_LINE))) expected_digest_sha512[SHA512_DIGESTSIZE] =
    "\x20\x4a\x8f\xc6\xdd\xa8\x2f\x0a\x0c\xed\x7b\xeb\x8e\x08\xa4\x16"
    "\x57\xc1\x6e\xf4\x68\xb2\x28\xa8\x27\x9b\xe3\x31\xa7\x03\xc3\x35"
    "\x96\xfd\x15\xc1\x3b\x1b\x07\xf9\xaa\x1d\x3b\xea\x57\x78\x9c\xa0"
    "\x31\xad\x85\xc7\xa7\x1d\xd7\x03\x54\xec\x63\x12\x38\xca\x34\x45";
uint8_t __attribute__((aligned(CACHE_LINE))) expected_digest_sm3[SM3_DIGESTSIZE] =
    "\x63\x9B\x6C\xC5\xE6\x4D\x9E\x37\xA3\x90\xB1\x92\xDF\x4F\xA1\xEA"
    "\x07\x20\xAB\x74\x7F\xF6\x92\xB9\xF3\x8C\x4E\x66\xAD\x7B\x8C\x05";

uint8_t __attribute__((aligned(CACHE_LINE))) expected_digest_md5_2times[MD5_DIGESTSIZE] =
    "\xe0\x7c\x2b\xd4\xd9\x60\x4f\x06\x04\x23\x1a\x1c\x59\x05\x86\xa5";
uint8_t __attribute__((aligned(CACHE_LINE))) expected_digest_sha1_2times[SHA1_DIGESTSIZE] =
    "\x06\xa7\x58\xf8\x03\x63\x7d\x2f\x2a\xe7\x91\x43\xc0\x65\xb6\xb0"
    "\x2d\x8a\x78\xa8";
uint8_t __attribute__((aligned(CACHE_LINE))) expected_digest_sha224_2times[SHA224_DIGESTSIZE] =
    "\x06\x2a\x8d\x12\xc4\x4d\xa3\xbb\x1f\x1a\x0a\xd6\xed\xbb\xa3\x7f"
    "\x7d\x61\x3a\x87\x9a\x77\x9c\x88\xbd\xa0\xa7\x85";
uint8_t __attribute__((aligned(CACHE_LINE))) expected_digest_sha256_2times[SHA256_DIGESTSIZE] =
    "\x0c\xff\xe1\x7f\x68\x95\x4d\xac\x3a\x84\xfb\x14\x58\xbd\x5e\xc9"
    "\x92\x09\x44\x97\x49\xb2\xb3\x08\xb7\xcb\x55\x81\x2f\x95\x63\xaf";
uint8_t __attribute__((aligned(CACHE_LINE))) expected_digest_sha384_2times[SHA384_DIGESTSIZE] =
    "\xbe\xf8\x3c\xd3\x53\xbe\x43\x4e\x18\x9c\xab\x0d\xc7\xe9\x72\x4c"
    "\x69\xf3\x16\xb9\xf3\x6c\xd4\x95\xe2\x71\x15\xd9\x8c\x03\xde\x39"
    "\x1c\xbd\x0c\x9a\x08\xfd\x8f\x08\xb0\xa0\xee\x78\x4e\x46\x1c\x95";
uint8_t __attribute__((aligned(CACHE_LINE))) expected_digest_sha512_2times[SHA512_DIGESTSIZE] =
    "\xd9\xf3\xad\x32\xd9\x0b\x9e\x82\x85\xa2\x0c\x16\xec\x72\x3f\xaf"
    "\x4c\xb1\xee\x9c\x23\x6b\xaf\x89\xb0\xd7\x19\x37\x69\x88\x04\x4a"
    "\x15\xd3\x01\x27\xbc\xed\xc3\xbd\x33\x85\x08\xf2\x2e\x7b\xed\x9a"
    "\xaf\x78\xf7\x8a\x28\x21\x27\x72\xc3\xa0\xd9\x45\xd6\xa8\x14\x88";
uint8_t __attribute__((aligned(CACHE_LINE))) expected_digest_sm3_2times[SM3_DIGESTSIZE] =
    "\x6A\x23\x1D\x75\x59\x2E\x6C\x6B\x4C\x38\x74\xB2\xDC\x24\xB5\x6C"
    "\x96\xC1\x43\x48\x44\xFC\x66\x29\xC7\xE7\xC6\x2C\xFC\xF4\xF9\x77";

uint8_t __attribute__((aligned(CACHE_LINE))) expected_digest_md5_h[MD5_DIGESTSIZE] =
    "\x57\x5f\x0a\xfe\x99\xe5\x7f\xea\x50\xf0\xed\x64\xa1\x96\x5e\x8f";
uint8_t __attribute__((aligned(CACHE_LINE))) expected_digest_sha1_h[SHA1_DIGESTSIZE] =
    "\x0d\x5d\xc5\x01\xb5\xb8\xf1\x9f\xba\xae\x38\x9c\xa0\xe6\xc8\x8d"
    "\x6a\x39\x15\x91";
uint8_t __attribute__((aligned(CACHE_LINE))) expected_digest_sha224_h[SHA224_DIGESTSIZE] =
    "\x65\x10\x2d\x78\xd7\xa7\xee\x3e\xf0\x58\x15\x2e\xe7\x6d\xf6\xae"
    "\xb7\x25\x20\x79\x1a\xe0\xe1\x1a\x08\x08\x4b\x94";
uint8_t __attribute__((aligned(CACHE_LINE))) expected_digest_sha256_h[SHA256_DIGESTSIZE] =
    "\x42\xc6\x4a\x5c\xf4\x03\x7e\x92\xf8\x62\x29\x66\x56\xc8\x8e\x66"
    "\x7c\xc2\x7f\x4e\x10\x41\x24\x86\x7f\x73\x18\x4d\x23\xb3\xed\x72";
uint8_t __attribute__((aligned(CACHE_LINE))) expected_digest_sha384_h[SHA384_DIGESTSIZE] =
    "\x3a\x8c\xf7\x70\xce\xed\x9a\x9e\xac\x88\xd8\x02\x46\x38\x07\x28"
    "\x5b\x5d\x37\x61\x9d\x8f\x29\xd0\x40\x99\x23\x86\xfd\x05\xe6\x82"
    "\x8e\xe7\x9e\x3e\x8e\xbe\x59\xbb\xef\x22\xa6\x17\x53\x5b\x6a\xc6";
uint8_t __attribute__((aligned(CACHE_LINE))) expected_digest_sha512_h[SHA512_DIGESTSIZE] =
    "\xf1\xc4\x2f\xd1\x00\xdd\xcd\x3b\xbe\x1d\x44\x9a\x88\x0e\xd6\x17"
    "\x8e\x79\x61\xa9\xe8\xb2\x9b\xca\x8e\x77\x8e\x35\x8a\x09\x56\x81"
    "\x1d\x64\x06\x31\x47\x32\x0f\xd3\xe5\x00\x66\x98\xf6\xaf\xf2\x00"
    "\x5c\xa7\xa0\xf1\x7e\x86\x95\xf0\x18\x9f\x5d\xbf\x24\xa6\x54\xca";
uint8_t __attribute__((aligned(CACHE_LINE))) expected_digest_sm3_h[SM3_DIGESTSIZE] =
    "not implement";

uint8_t __attribute__((aligned(CACHE_LINE))) expected_digest_md5_h_2times[MD5_DIGESTSIZE] =
    "\x51\x09\x0c\x20\xc6\xa9\x60\x4c\xe0\xc7\x75\xa9\xcf\x67\x22\xdf";
uint8_t __attribute__((aligned(CACHE_LINE))) expected_digest_sha1_h_2times[SHA1_DIGESTSIZE] =
    "\x11\x80\xc2\x93\x16\xcb\x59\x75\x57\x90\xf2\x2c\xff\x45\x89\x9d"
    "\x5c\xd8\x8b\x11";
uint8_t __attribute__((aligned(CACHE_LINE))) expected_digest_sha224_h_2times[SHA224_DIGESTSIZE] =
    "\x4a\xb4\x31\x21\x5c\xcd\x45\xf0\x42\xd4\x92\xdd\xbc\x65\xc2\xf9"
    "\x1a\x93\x02\xae\xf4\xaa\xdb\x50\x16\xc1\x5b\xe3";
uint8_t __attribute__((aligned(CACHE_LINE))) expected_digest_sha256_h_2times[SHA256_DIGESTSIZE] =
    "\xf4\x85\x83\x49\x9c\xa8\xdd\x43\xff\xcd\x88\xde\xaf\xe5\x7a\xcd"
    "\xfc\xe1\x98\xa7\x0e\x8b\x6d\x91\x99\xff\x14\x82\x0d\x17\xe5\x58";
uint8_t __attribute__((aligned(CACHE_LINE))) expected_digest_sha384_h_2times[SHA384_DIGESTSIZE] =
    "\x18\x2a\xc9\xac\x57\x5c\x90\x08\x06\xda\xfb\x4f\x00\xf8\x75\xa6"
    "\x93\xe9\x87\x16\xb6\x46\x51\x2e\x30\x1a\x45\x8c\x16\xc6\x20\x68"
    "\x34\x6f\xd3\x92\x12\xdc\xf4\x54\x53\xdd\xe7\xa6\x6b\xd7\x17\x85";
uint8_t __attribute__((aligned(CACHE_LINE))) expected_digest_sha512_h_2times[SHA512_DIGESTSIZE] =
    "\xe1\x14\x4f\xed\x1a\xc0\xe5\x52\xad\xa1\x79\x77\x80\x4a\x2e\x6c"
    "\x75\xe9\x47\x05\xd8\x21\xd3\xcb\x39\x04\x75\x88\x98\x18\xfa\xd8"
    "\xc6\x94\x98\xa5\xea\x31\xdc\x58\xc2\x77\xb7\x3f\x72\x5f\xd3\x66"
    "\xc6\xbf\x70\x43\x38\xaf\x3f\x0a\x27\x67\xb8\xbc\x46\xf9\x37\x1c";
uint8_t __attribute__((aligned(CACHE_LINE))) expected_digest_sm3_h_2times[SM3_DIGESTSIZE] =
    "not implement";

//data for aligned block with no padding
char __attribute__((aligned(CACHE_LINE))) block_align_sha256[SHA256_BLOCKSIZE] =
    "abcdbcdecdefdefgefghfghighijhijkijkljklmklmnlmnomnopnopqabcdefgh";
uint8_t __attribute__((aligned(CACHE_LINE))) expected_digest_align_h[SHA256_BLOCKSIZE] =
    "\x59\x61\xe8\xfd\x00\xe1\xae\x8c\xe7\x90\x21\xde\x3d\xe8\x93\xd7"
    "\x6f\x5c\x0a\xf7\x6a\xc2\xca\xe0\x98\x3f\x7c\xc4\x3b\xbb\x4c\x11";

//data for long key test
char __attribute__((aligned(CACHE_LINE))) key_big[112] =
    "abcdbcdecdefdefgefghfghighijhijkijkljklmklmnlmnomnopnopqabcdbcdecdefdefgefghfghighijhijkijkljklmklmnlmnomnopnopq";

uint8_t __attribute__((aligned(CACHE_LINE))) expected_digest_big_key_h[32] =//256
    "\x6e\xdf\x4c\xdb\x2f\x1d\xb8\xa1\x53\x93\xf7\x01\x15\x3b\x66\x5e"
    "\x5d\x11\x93\x1b\x13\xed\xe3\x39\xf7\xbe\x86\x64\x7e\xb3\x1c\x9b";

//data for performance test
char __attribute__((aligned(CACHE_LINE))) key_perf[32] = "passwordpasswordpasswordpassword";
char __attribute__((aligned(CACHE_LINE))) input_data_perf[96] =
    "abcdbcdecdefdefgefghfghighijhijkijkljklmklmnlmnomnopnopqabcdefghpasswordpasswordpasswordpassword";

uint8_t __attribute__((aligned(CACHE_LINE))) expected_digest_md5_perf[MD5_DIGESTSIZE] =
    "\x20\x29\xcb\x25\x01\x5f\x88\x49\x98\xbb\xc2\x99\x96\x62\x72\x73";
uint8_t __attribute__((aligned(CACHE_LINE))) expected_digest_sha1_perf[SHA1_DIGESTSIZE] =
    "\x42\x2c\xa9\x9f\x52\x37\x3d\x4e\x90\xce\x19\xd7\xb4\x24\xb5\x12"
    "\x59\x0c\x31\xdb";
uint8_t __attribute__((aligned(CACHE_LINE))) expected_digest_sha224_perf[SHA224_DIGESTSIZE] =
    "\x8d\x4d\xfa\x5f\x5f\x7d\x5b\x09\xda\x4a\x9b\xf8\x4e\x16\x95\x3c"
    "\xf4\xcb\x92\xba\xaf\xf6\x2f\x41\x2f\x91\xf6\x1b";
uint8_t __attribute__((aligned(CACHE_LINE))) expected_digest_sha256_perf[SHA256_DIGESTSIZE] =
    "\xf4\xbc\x19\x36\xc2\x98\x46\x6e\xf3\x1a\xb9\xeb\x86\x93\x3f\x00"
    "\xba\x29\x42\xed\xad\xf8\xca\xd5\xcf\x60\x7e\x18\x16\x6e\xf4\xd7";
uint8_t __attribute__((aligned(CACHE_LINE))) expected_digest_sha384_perf[SHA384_DIGESTSIZE] =
    "\x15\x13\x6b\xc1\x9b\x6e\x19\xe2\x67\x3a\x40\xfd\xc3\x75\x9b\x14"
    "\xa2\x77\xb0\xf0\xbe\xdf\x04\x96\x72\xce\xc2\x69\x16\xd7\x39\x2b"
    "\x3e\xe3\x36\xb1\xcb\x20\x2f\xde\xbf\xa4\xf6\x6c\x5f\x89\x55\xd7";
uint8_t __attribute__((aligned(CACHE_LINE))) expected_digest_sha512_perf[SHA512_DIGESTSIZE] =
    "\x56\xd3\xe1\x9d\xbb\x11\x06\x06\x75\x28\x42\xe8\x97\x62\x6e\x8e"
    "\xbe\xe1\xd8\xd6\xa4\x38\xab\xad\xab\x76\x4b\x92\x1f\x0c\x9f\x93"
    "\xed\x40\xe9\xca\x13\x8b\xbf\x0a\x79\x0e\xb6\xf3\x82\x5f\xe6\xa9"
    "\xed\xfd\x02\xe0\xff\x13\x46\xfb\x3f\xb0\xbf\x63\x86\x56\x5d\x02";
uint8_t __attribute__((aligned(CACHE_LINE))) expected_digest_sm3_perf[SM3_DIGESTSIZE] =
    "\x12\xa7\xe3\x88\xcb\x91\x78\xb5\xf3\xdd\x27\x74\x25\x80\xe9\xc1"
    "\x39\x65\x36\xa3\x5c\xec\x59\x91\x52\x8d\x36\xf0\x21\x28\xaf\x1b";

uint8_t __attribute__((aligned(CACHE_LINE))) expected_digest_md5_perf_h[MD5_DIGESTSIZE] =
    "\x76\xc6\x52\xc8\xd0\x64\x7b\xc4\xca\xc9\xa6\xb7\x25\xae\xee\xe9";
uint8_t __attribute__((aligned(CACHE_LINE))) expected_digest_sha1_perf_h[SHA1_DIGESTSIZE] =
    "\x2d\xb8\x77\xee\x77\x9f\xa3\xb9\x5f\x2b\x61\x4a\x27\xc7\x78\x94"
    "\x12\xb1\x38\x85";
uint8_t __attribute__((aligned(CACHE_LINE))) expected_digest_sha224_perf_h[SHA224_DIGESTSIZE] =
    "\x68\x08\x9c\x00\xc5\xdf\xc8\x19\x5f\xa3\xfd\x3d\x50\x45\xeb\xfd"
    "\x92\x95\xc5\x3c\x19\xc6\xd5\x1b\x58\x12\xe3\xf4";
uint8_t __attribute__((aligned(CACHE_LINE))) expected_digest_sha256_perf_h[SHA256_DIGESTSIZE] =
    "\x68\x48\xa3\xa0\xab\xc5\xdf\x0e\x10\x9a\x09\x66\x95\x5e\x65\x2b"
    "\xb9\x7e\xe9\x43\xcb\x34\x8b\xd6\x5a\x04\x26\x59\x9f\x7b\x4e\x25";
uint8_t __attribute__((aligned(CACHE_LINE))) expected_digest_sha384_perf_h[SHA384_DIGESTSIZE] =
    "\x59\x7c\x9c\x1c\x68\x6c\xf2\x98\x0c\x1c\xf7\x6f\x0c\x3c\xe2\xff"
    "\xad\x4e\xd9\xa7\x1e\xfd\x3d\x38\x21\xab\x90\xe4\xdf\x06\x75\xf3"
    "\xf6\x47\xc3\x11\x65\x30\x22\x1e\x90\xfa\x1e\x06\xe8\x15\x6b\xf7";
uint8_t __attribute__((aligned(CACHE_LINE))) expected_digest_sha512_perf_h[SHA512_DIGESTSIZE] =
    "\x1b\xb3\xcb\x59\x83\x20\x17\x46\xa4\x86\x74\xad\x1c\x46\x99\x55"
    "\x6a\x81\xf4\xf7\x28\x08\x5e\x03\x66\x6c\x25\x29\x03\xe5\x61\x51"
    "\xd8\x8d\x87\x75\x52\x59\x3c\x3f\xa9\xa4\xe7\x26\x31\x2f\x22\xf2"
    "\xe6\x24\x65\x4c\x81\x17\x33\x55\xf5\x33\x30\x86\xf9\x50\x3f\xe5";
uint8_t __attribute__((aligned(CACHE_LINE))) expected_digest_sm3_perf_h[SM3_DIGESTSIZE] =
    "";

//data for multi-part test
const char __attribute__((aligned(CACHE_LINE))) input_data_multi[704] =
    "Thischapterisintendedtocommunicate,guideandillustrateaPCBdesigns"
    "trategyresultinginaPCBthatcansupportTI'slatestApplicationProcess"
    "or.ThisProcessorisahigh-performanceprocessordesignedforautomotiv"
    "eInfotainmentandAdvancedDriverAssistanceSystemsbasedonenhancedOM"
    "AP?architectureintegratedona28-nmCMOSprocesstechnology.Theseguid"
    "elinesfirstfocusondesigningarobustPowerDeliveryNetwork(PDN)which"
    "isessentialtoachievethedesirablehighperformanceprocessingavailab"
    "leonDevice.Thegeneralprinciplesandstepby-stepapproachforimplemen"
    "tinggoodpowerintegrity(PI)withspecificrequirementswillbedescribe"
    "dforthekeyDevicepowerdomains.TIstronglybelievesthatsimulatingaPC"
    "B'sproposedPDNisrequiredforfirstpassPCBdesignsuc";
uint32_t inputdata_multi_size = 688;
uint8_t __attribute__((aligned(CACHE_LINE))) expected_digest_multi[SHA256_DIGESTSIZE] =
    "\x1f\x77\xbd\xa0\x73\x32\xa1\x3e\x67\x46\x44\x14\x83\x1b\x3a\xf1"
    "\xd0\x4a\x4b\x0b\x01\x47\x7f\xc8\x6c\xcb\x13\x2f\x57\x91\x36\x8b";

//debug stress test
uint8_t __attribute__((aligned(CACHE_LINE))) expected_digest_multi_part[10][SHA256_DIGESTSIZE] = {
    /*1*/{"\xc9\x6f\xe0\x14\x5b\x1e\x83\x66\x73\x32\x82\xc1\xd0\x9a\x9a\x6b"
        "\x64\xc7\x98\x62\xe1\x43\xae\x9b\x27\x83\x45\xda\xf6\xd5\x66\x4a"
    },
    /*2*/{"\x0a\xc1\xeb\x2c\x38\x85\x65\xc3\x74\xd5\x48\x8b\xd5\x46\x6d\x39"
        "\x8d\x87\x99\xc0\x5a\xf8\xf5\xa8\xdc\xd3\x2e\x0b\xc9\xe2\x0a\x0d"
    },
    /*3*/{"\x0b\x9f\xc3\x63\x25\x72\xba\x12\x99\xb3\x01\x7e\x51\x6d\xbe\x3a"
        "\x11\x52\x4e\xa7\xfe\x20\xcd\xdd\xb3\xa4\x73\xab\xb8\x2e\x16\x38"
    },
    /*4*/{"\xa9\x24\xa5\xf4\x0f\x04\x3d\xcb\x89\xf7\xbe\x89\x08\x6c\x67\x0d"
        "\x98\xac\xde\x7e\xe1\x97\x54\x9d\x47\x08\xec\xdf\x88\x35\x56\xfd"
    },
    /*5*/{"\x9c\xca\xb8\x75\x78\x9f\xea\xb7\x4d\xab\xb6\x94\xbc\xad\x66\x8a"
        "\xf0\xa2\xd1\x69\x04\x5c\xfd\x9b\xf7\x5a\x27\x54\xfd\xba\x02\xbd"
    },
    /*6*/{"\xd1\xba\xad\xc7\x71\xeb\xac\xd6\x69\xd6\x3c\x37\x40\x2d\x18\x99"
        "\x09\x9e\xfe\xff\x3b\xa5\xef\x56\x5f\xa8\x02\x74\x62\xb7\xba\x9c"
    },
    /*7*/{"\xfb\xd0\xcd\xfd\x23\x9e\xf0\x40\x3f\x3f\x74\xf4\x04\xea\xf7\x38"
        "\xbc\xb2\x45\x1c\xc3\x64\x43\xe9\x33\x2f\x21\xcc\x4d\x7d\x09\x30"
    },
    /*8*/{"\xd1\x4f\xf7\xfb\x37\x20\x7a\x14\x54\x2b\x27\xb3\xcb\x75\x32\xc9"
        "\xdc\xbf\x61\x3e\xd5\xdc\x61\xa2\xde\x7d\x09\x1e\x4a\x7c\x38\x2a"
    },
    /*9*/{"\x94\xa4\x7f\x6f\x20\xe4\x1e\x18\x5b\x93\xbc\x9f\x84\x8c\x00\xb1"
        "\x99\x69\x60\xce\x95\x8b\x22\xb7\x57\x1a\xe5\x44\x2d\x1a\x52\x21"
    },
    /*10*/{"\xd3\x4f\x0c\x77\x06\x15\x28\xcb\x1b\xae\x7d\x3a\x12\x12\x9a\x99"
        "\x6d\x68\xe1\xfd\x0e\x2a\x79\x5c\x9f\x44\xf3\x33\x0d\x21\x30\x29"
    }
};

void get_init_value(hash_alg_t alg, uint8_t* iv)
{
    switch (alg) {
        case ALG_MD5:
            memcpy(iv, md5_iv, MD5_INITSIZE);
            break;

        case ALG_SHA1:
            memcpy(iv, sha1_iv, SHA1_INITSIZE);
            break;

        case ALG_SHA224:
            memcpy(iv, sha224_iv, SHA224_INITSIZE);
            break;

        case ALG_SHA256:
            memcpy(iv, sha256_iv, SHA256_INITSIZE);
            break;

        case ALG_SHA384:
            memcpy(iv, sha384_iv, SHA384_INITSIZE);
            break;

        case ALG_SHA512:
            memcpy(iv, sha512_iv, SHA512_INITSIZE);
            break;

        case ALG_SM3:
            memcpy(iv, sm3_iv, SM3_INITSIZE);
            break;

        default:
            ;
    }
}

void ce_printf(hash_alg_t alg, bool iv_enable, buff_addr_type_t iv_addr_type, bool hmac,
               buff_addr_type_t key_addr_type, buff_addr_type_t src_addr_type, buff_addr_type_t dst_addr_type,
               bool pass, uint8_t* fail_result, uint32_t result_len)
{
    LTRACEF("ALG: %d, SWIV: %u, IV_ADDR: %d, HMAC: %d, KEY_ADDR: %d, SRC_ADDR: %d, DST_ADDR: %d, DIG_LEN: %d, RESULT: %s",
            alg, iv_enable, iv_addr_type, hmac, key_addr_type, src_addr_type, dst_addr_type, result_len, pass ? "PASS" : "FAIL");

    if (!pass) {
        dprintf(CRITICAL, ", FAIL_DIGEST:\n");

        for (uint32_t i = 0; i < result_len; i++) {
            dprintf(CRITICAL, "0x%02x ", *(fail_result + i));

            if (0 != i && 0 == (i + 1) % 16) {
                dprintf(CRITICAL, "\n");
            }

            if (i > SHA512_DIGESTSIZE) {
                break;
            }
        }

        dprintf(CRITICAL, "\n\n");
    }
    else {
        dprintf(CRITICAL, "\n");
    }
}

void ce_printf_perf(hash_alg_t alg, bool key_en, uint32_t key_size,
                    buff_addr_type_t src_type, uint32_t src_size, buff_addr_type_t dst_type, uint64_t time_slice)
{
    LTRACEF("ALG: %d, Key enable: %d, Key size: %d, src addr type: %d, input size: %d, dst addr type: %d, slice: %llu\n",
            alg, key_en, key_size, src_type, src_size, dst_type, time_slice);
}
